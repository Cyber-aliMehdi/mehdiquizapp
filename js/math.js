const questions = [
    {
        question: "What is 5 + 3?",
        answer: [
            { text: "8", correct: true },
            { text: "6", correct: false },
            { text: "9", correct: false },
            { text: "7", correct: false },
        ]
    },
    {
        question: "What is 10 - 4?",
        answer: [
            { text: "6", correct: true },
            { text: "5", correct: false },
            { text: "4", correct: false },
            { text: "7", correct: false },
        ]
    },
    {
        question: "What is 3 × 4?",
        answer: [
            { text: "12", correct: true },
            { text: "9", correct: false },
            { text: "15", correct: false },
            { text: "16", correct: false },
        ]
    },
    {
        question: "What is 16 ÷ 4?",
        answer: [
            { text: "4", correct: true },
            { text: "5", correct: false },
            { text: "6", correct: false },
            { text: "3", correct: false },
        ]
    },
    {
        question: "What is the square root of 49?",
        answer: [
            { text: "7", correct: true },
            { text: "6", correct: false },
            { text: "9", correct: false },
            { text: "8", correct: false },
        ]
    },
    {
        question: "What is 100 - 25?",
        answer: [
            { text: "75", correct: true },
            { text: "50", correct: false },
            { text: "25", correct: false },
            { text: "80", correct: false },
        ]
    },
    {
        question: "What is 2³?",
        answer: [
            { text: "8", correct: true },
            { text: "6", correct: false },
            { text: "9", correct: false },
            { text: "4", correct: false },
        ]
    },
    {
        question: "What is the sum of 7 and 6?",
        answer: [
            { text: "13", correct: true },
            { text: "12", correct: false },
            { text: "14", correct: false },
            { text: "15", correct: false },
        ]
    },
    {
        question: "What is 25 ÷ 5?",
        answer: [
            { text: "5", correct: true },
            { text: "4", correct: false },
            { text: "6", correct: false },
            { text: "7", correct: false },
        ]
    },
    {
        question: "What is 9 × 2?",
        answer: [
            { text: "18", correct: true },
            { text: "16", correct: false },
            { text: "20", correct: false },
            { text: "14", correct: false },
        ]
    },
    {
        question: "What is 1 + 1?",
        answer: [
            { text: "2", correct: true },
            { text: "0", correct: false },
            { text: "1", correct: false },
            { text: "3", correct: false },
        ]
    },
    {
        question: "What is 12 ÷ 3?",
        answer: [
            { text: "4", correct: true },
            { text: "5", correct: false },
            { text: "6", correct: false },
            { text: "3", correct: false },
        ]
    },
    {
        question: "What is 15 - 7?",
        answer: [
            { text: "8", correct: true },
            { text: "7", correct: false },
            { text: "9", correct: false },
            { text: "6", correct: false },
        ]
    },
    {
        question: "What is 6 × 6?",
        answer: [
            { text: "36", correct: true },
            { text: "30", correct: false },
            { text: "42", correct: false },
            { text: "48", correct: false },
        ]
    },
    {
        question: "What is 100 ÷ 10?",
        answer: [
            { text: "10", correct: true },
            { text: "20", correct: false },
            { text: "5", correct: false },
            { text: "15", correct: false },
        ]
    },
    {
        question: "What is 4²?",
        answer: [
            { text: "16", correct: true },
            { text: "12", correct: false },
            { text: "20", correct: false },
            { text: "14", correct: false },
        ]
    },
    {
        question: "What is 3 + 7?",
        answer: [
            { text: "10", correct: true },
            { text: "9", correct: false },
            { text: "11", correct: false },
            { text: "12", correct: false },
        ]
    },
    {
        question: "What is 81 ÷ 9?",
        answer: [
            { text: "9", correct: true },
            { text: "8", correct: false },
            { text: "7", correct: false },
            { text: "6", correct: false },
        ]
    },
    {
        question: "What is 2 × 10?",
        answer: [
            { text: "20", correct: true },
            { text: "18", correct: false },
            { text: "22", correct: false },
            { text: "15", correct: false },
        ]
    },
    {
        question: "What is 50 + 25?",
        answer: [
            { text: "75", correct: true },
            { text: "80", correct: false },
            { text: "85", correct: false },
            { text: "70", correct: false },
        ]
    },
    {
        question: "What is 7 × 8?",
        answer: [
            { text: "56", correct: true },
            { text: "54", correct: false },
            { text: "58", correct: false },
            { text: "60", correct: false },
        ]
    },
    {
        question: "What is 90 - 30?",
        answer: [
            { text: "60", correct: true },
            { text: "70", correct: false },
            { text: "50", correct: false },
            { text: "40", correct: false },
        ]
    },
    {
        question: "What is 11 × 2?",
        answer: [
            { text: "22", correct: true },
            { text: "20", correct: false },
            { text: "24", correct: false },
            { text: "18", correct: false },
        ]
    },
    {
        question: "What is 36 ÷ 6?",
        answer: [
            { text: "6", correct: true },
            { text: "5", correct: false },
            { text: "7", correct: false },
            { text: "8", correct: false },
        ]
    },
        {
            question: "What is 5 + 3?",
            answer: [
                { text: "8", correct: true },
                { text: "6", correct: false },
                { text: "9", correct: false },
                { text: "7", correct: false },
            ]
        },
        {
            question: "What is 12 - 4?",
            answer: [
                { text: "8", correct: true },
                { text: "10", correct: false },
                { text: "6", correct: false },
                { text: "9", correct: false },
            ]
        },
        {
            question: "What is 3 x 3?",
            answer: [
                { text: "9", correct: true },
                { text: "6", correct: false },
                { text: "12", correct: false },
                { text: "15", correct: false },
            ]
        },
        {
            question: "What is 20 ÷ 5?",
            answer: [
                { text: "4", correct: true },
                { text: "5", correct: false },
                { text: "6", correct: false },
                { text: "3", correct: false },
            ]
        },
        {
            question: "What is the square root of 49?",
            answer: [
                { text: "7", correct: true },
                { text: "6", correct: false },
                { text: "8", correct: false },
                { text: "9", correct: false },
            ]
        },
        {
            question: "What is 10 + 15?",
            answer: [
                { text: "25", correct: true },
                { text: "20", correct: false },
                { text: "30", correct: false },
                { text: "35", correct: false },
            ]
        },
        {
            question: "What is 16 ÷ 4?",
            answer: [
                { text: "4", correct: true },
                { text: "6", correct: false },
                { text: "3", correct: false },
                { text: "5", correct: false },
            ]
        },
        {
            question: "What is 6 x 7?",
            answer: [
                { text: "42", correct: true },
                { text: "36", correct: false },
                { text: "48", correct: false },
                { text: "49", correct: false },
            ]
        },
        {
            question: "What is 15 - 6?",
            answer: [
                { text: "9", correct: true },
                { text: "7", correct: false },
                { text: "8", correct: false },
                { text: "10", correct: false },
            ]
        },
        {
            question: "What is 81 ÷ 9?",
            answer: [
                { text: "9", correct: true },
                { text: "8", correct: false },
                { text: "10", correct: false },
                { text: "7", correct: false },
            ]
        },
        {
            question: "What is the square of 5?",
            answer: [
                { text: "25", correct: true },
                { text: "20", correct: false },
                { text: "30", correct: false },
                { text: "35", correct: false },
            ]
        },
        {
            question: "What is 24 ÷ 6?",
            answer: [
                { text: "4", correct: true },
                { text: "5", correct: false },
                { text: "6", correct: false },
                { text: "3", correct: false },
            ]
        },
        {
            question: "What is 11 + 7?",
            answer: [
                { text: "18", correct: true },
                { text: "16", correct: false },
                { text: "19", correct: false },
                { text: "17", correct: false },
            ]
        },
        {
            question: "What is 4²?",
            answer: [
                { text: "16", correct: true },
                { text: "12", correct: false },
                { text: "14", correct: false },
                { text: "18", correct: false },
            ]
        },
        {
            question: "What is 14 - 8?",
            answer: [
                { text: "6", correct: true },
                { text: "5", correct: false },
                { text: "7", correct: false },
                { text: "4", correct: false },
            ]
        },
        {
            question: "What is 3³?",
            answer: [
                { text: "27", correct: true },
                { text: "21", correct: false },
                { text: "30", correct: false },
                { text: "24", correct: false },
            ]
        },
        {
            question: "What is 18 ÷ 3?",
            answer: [
                { text: "6", correct: true },
                { text: "5", correct: false },
                { text: "7", correct: false },
                { text: "8", correct: false },
            ]
        },
        {
            question: "What is 50 - 25?",
            answer: [
                { text: "25", correct: true },
                { text: "30", correct: false },
                { text: "20", correct: false },
                { text: "35", correct: false },
            ]
        },
        {
            question: "What is 5 x 6?",
            answer: [
                { text: "30", correct: true },
                { text: "28", correct: false },
                { text: "32", correct: false },
                { text: "25", correct: false },
            ]
        },
        {
            question: "What is 9²?",
            answer: [
                { text: "81", correct: true },
                { text: "72", correct: false },
                { text: "64", correct: false },
                { text: "90", correct: false },
            ]
        },
        {
            question: "What is 100 ÷ 10?",
            answer: [
                { text: "10", correct: true },
                { text: "9", correct: false },
                { text: "11", correct: false },
                { text: "12", correct: false },
            ]
        },
        {
            question: "What is 4 x 8?",
            answer: [
                { text: "32", correct: true },
                { text: "36", correct: false },
                { text: "28", correct: false },
                { text: "40", correct: false },
            ]
        },
        {
            question: "What is 90 - 45?",
            answer: [
                { text: "45", correct: true },
                { text: "50", correct: false },
                { text: "40", correct: false },
                { text: "55", correct: false },
            ]
        },
        {
            question: "What is 10³?",
            answer: [
                { text: "1000", correct: true },
                { text: "100", correct: false },
                { text: "1100", correct: false },
                { text: "1200", correct: false },
            ]
        },
        {
            question: "What is 6 x 9?",
            answer: [
                { text: "54", correct: true },
                { text: "56", correct: false },
                { text: "52", correct: false },
                { text: "60", correct: false },
            ]
        }
];


const questionData = document.getElementById("question");
const answerButtons = document.getElementById("answerButtons");
const nextButton = document.getElementById("nextButton");
const questionCount = document.getElementById("questionCount");
let timerElement = document.getElementById("timer");
let time = 10;

let timerAudio = new Audio("../audios/10 Seconds Timer.mp3");
let hooray = new Audio("../audios/hooray.mp3")

function correctAnswer() {
    let click = new Audio("../audios/Correct Answer sound effect - Sound Effects.mp3");
    click.play();
}

function wrongAnswer() {
    let click = new Audio("../audios/buzzer-or-wrong-answer-20582.mp3");
    click.play();
}

let currentQuestionIndex = 0;
let score = 0;

function shuffleArray(array) {
    for (i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function shuffleAnswers(questions) {
    return questions.map(question => {
        return {
            ...question,
            answer: shuffleArray([...question.answer])
        };
    });
}

function startQuiz() {
    timerElement.style.display = "block";
    clearInterval(interval);
    time = 10;
    interval = setInterval(Timer, 1000);
    Timer();

    shuffleArray(questions);
    shuffledQuestions = questions.slice(0, 20);

    shuffledQuestions = shuffleAnswers(shuffledQuestions);

    currentQuestionIndex = 0;
    score = 0;
    nextButton.innerHTML = "Next";
    showQuestion();
}

function showQuestion() {
    clearPage();
    let currentQuestion = shuffledQuestions[currentQuestionIndex];
    let questionNo = currentQuestionIndex + 1;
    questionData.innerHTML = questionNo + ". " + currentQuestion.question;

    currentQuestion.answer.forEach(answer => {
        const button = document.createElement("button");
        button.textContent = answer.text;
        button.classList.add("btn");
        answerButtons.appendChild(button);
        if (answer.correct) {
            button.dataset.correct = answer.correct;
        }
        button.addEventListener("click", selectAnswer);
    });
}

function selectAnswer(e) {
    const selectedBtn = e.target;
    const correct = selectedBtn.dataset.correct === "true";
        timerAudio.pause();
        timerAudio.currentTime = 0;

    if (correct) {
        selectedBtn.classList.add("correct");
        correctAnswer();
        score++;
    } else {
        selectedBtn.classList.add("incorrect");
        wrongAnswer();
    }
    Array.from(answerButtons.children).forEach(button => {
        if (button.dataset.correct === "true") {
            button.classList.add("correct");
        }
        button.disabled = true;
    });
    nextButton.style.display = "block";
    clearInterval(interval);
}

nextButton.addEventListener("click", () => {
    if (currentQuestionIndex < shuffledQuestions.length) {
        nextButtonClick();
    } else {
        startQuiz();
    }
});

let params = new URLSearchParams(window.location.search);
let username = params.get("name");

function endScreen() {
    clearInterval(interval);
    timerAudio.pause();
    timerAudio.currentTime = 0;
    timerElement.style.display = "none";
    questionData.innerHTML = `Congrats! ${username} You Scored ${score} Out Of ${shuffledQuestions.length}!`;
    if(score>=15){
        hooray.play();
    }
    nextButton.innerHTML = "Play Again";
    nextButton.style.display = "block";
}

function nextButtonClick() {
    clearInterval(interval);
    time = 10;
    interval = setInterval(Timer, 1000);
    Timer();
    clearPage();
    currentQuestionIndex++;
    if (currentQuestionIndex < shuffledQuestions.length) {
        showQuestion();
    } else {
        endScreen();
    }
}

function clearPage() {
    nextButton.style.display = "none";
    while (answerButtons.firstChild) {
        answerButtons.removeChild(answerButtons.firstChild);
    }
}

function Timer() {
    timerAudio.play();
    let seconds = time % 60;
    timerElement.innerHTML = `${seconds}`;
    time--;
    if (time < 0) {
        clearInterval(interval);
        timerElement.innerHTML = "Time's up!";
        Array.from(answerButtons.children).forEach(button => {
            button.disabled = true;
            if (button.dataset.correct === "true") {
                button.classList.add("correct");
            }
        });
        nextButton.style.display = "block";
    }
}

let interval = setInterval(Timer, 1000);

startQuiz();